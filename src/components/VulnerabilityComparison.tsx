import React from 'react';
import { Row, Col, Typography, Tag, List, Divider } from 'antd';

const { Title } = Typography;

interface VulnerabilityComparisonProps {
  data: any;
}

const renderSeverityTags = (counts: any) => (
  <div style={{ marginBottom: 12 }}>
    <Tag color="red">Critical: {counts.critical}</Tag>
    <Tag color="volcano">High: {counts.high}</Tag>
    <Tag color="gold">Medium: {counts.medium}</Tag>
    <Tag color="blue">Low: {counts.low}</Tag>
  </div>
);

const renderVulnList = (list: any[]) => (
  <List
    size="small"
    bordered
    dataSource={list}
    renderItem={(item) => (
      <List.Item>
        <Tag color={getSeverityColor(item.severity)}>{item.severity}</Tag>
        {item.id}
      </List.Item>
    )}
    style={{ maxHeight: 300, overflowY: 'auto' }}
  />
);

const getSeverityColor = (severity: string) => {
  switch (severity.toLowerCase()) {
    case 'critical':
      return 'red';
    case 'high':
      return 'volcano';
    case 'medium':
      return 'gold';
    case 'low':
      return 'blue';
    default:
      return 'gray';
  }
};

const VulnerabilityComparison: React.FC<VulnerabilityComparisonProps> = ({ data }) => {
  const { baseVersion, goldVersion, vulnerabilities } = data;

  return (
    <Row gutter={32}>
      {/* Base Version */}
      <Col span={12}>
        <Title level={5}>Base Version: {baseVersion}</Title>
        <Tag color="magenta">Total: {vulnerabilities.base.total}</Tag>
        {renderSeverityTags(vulnerabilities.base.counts)}
        <Divider style={{ margin: '8px 0' }}>Details</Divider>
        {renderVulnList(vulnerabilities.base.list)}
      </Col>

      {/* Gold Version */}
      <Col span={12}>
        <Title level={5}>Gold Version: {goldVersion}</Title>
        <Tag color="green">Total: {vulnerabilities.gold.total}</Tag>
        {renderSeverityTags(vulnerabilities.gold.counts)}
        <Divider style={{ margin: '8px 0' }}>Details</Divider>
        {renderVulnList(vulnerabilities.gold.list)}
      </Col>
    </Row>
  );
};

export default VulnerabilityComparison;
